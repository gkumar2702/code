stages:
  - deploy_0001
before_script:
  - export TZ='Asia/Kolkata'
deploying_dag_file_into_gcs-prod:
  stage: deploy_test
  image: google/cloud-sdk
  tags: ["stages"]
  only: 
    - master
  only:
    changes:
      - .gitlab-ci.yml
  script:
    - apt-get install python3-openssl -qy
    - echo 'nameserver 1.1.1.1'  > /etc/resolv.conf
    - echo 'nameserver 1.0.0.1' >> /etc/resolv.conf
    - mkdir -p ./creds
    - echo $composer_key_0001 | base64 -d > ./creds/composer_key_0001.json
    - export GOOGLE_CREDENTIALS=$(cat ./creds/composer_key_0001.json)
    - gcloud auth activate-service-account $composer_sa_0001 --key-file=./creds/composer_key_0001.json
    - gsutil rsync "Development"  gs://us-east4-composer-0001-40ca8a74-bucket/data/Outage_restoration/IPL/Python_scripts/Gitlab_test

